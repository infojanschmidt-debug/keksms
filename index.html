<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>OnlyKeks ‚Äì Post, die schmeckt</title>
  <meta name="description" content="Schicke s√º√üe Botschaften mit direkter QR-Antwort. QR-Antwort-Keks ohne Account ‚Äì in wenigen Klicks." />
  <link rel="canonical" href="https://infojanschmidt-debug.github.io/keksms/" />
  <meta name="robots" content="index,follow" />
  <meta name="theme-color" content="#ff4fa3" />

  <meta property="og:title" content="OnlyKeks ‚Äì Post, die schmeckt" />
  <meta property="og:description" content="Schicke s√º√üe Botschaften mit direkter QR-Antwort. QR-Antwort-Keks ohne Account ‚Äì in wenigen Klicks." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://infojanschmidt-debug.github.io/keksms/" />
  <meta property="og:image" content="https://infojanschmidt-debug.github.io/keksms/assets/img/1000149739.jpg" />

  <style>
    :root{
      --bg:#fff;
      --ink:#0b1b2a;
      --muted:#5b6a79;
      --line: rgba(11,27,42,.10);

      --pink:#ff4fa3;
      --pinkSoft: rgba(255,79,163,.10);

      --shadow: 0 10px 25px rgba(11,27,42,.06);
      --radius: 16px;
      --max: 1040px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background: var(--bg);
      color: var(--ink);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      overflow-x:hidden;
    }
    a{color:inherit}
    .wrap{max-width:var(--max); margin:0 auto; padding:0 18px}
    .muted{color:var(--muted)}
    .hr{height:1px;background:var(--line);border:0;margin:18px 0}

    /* Gate: Seite erst sichtbar wenn Intro done */
    html:not(.appReady) body > *:not(#intro) { visibility: hidden; }

    /* Intro Overlay */
    .intro{
      position:fixed; inset:0; z-index:9999;
      background:#000;
      display:grid; place-items:center;
    }
    .introVid{width:100%;height:100%;object-fit:cover}
    .introSkip{
      position:absolute; right:14px; top:14px;
      border:1px solid rgba(255,255,255,.25);
      background: rgba(0,0,0,.35);
      color:#fff;
      padding:10px 14px;
      border-radius:999px;
      font-weight:800;
      backdrop-filter: blur(10px);
      cursor:pointer;
    }
    .intro.hide{opacity:0; pointer-events:none; transition: opacity .22s ease}

    /* Topbar */
    .topbar{
      position:sticky; top:0; z-index:50;
      background: rgba(255,255,255,.92);
      border-bottom:1px solid var(--line);
      backdrop-filter: blur(14px);
    }
    .topbar .inner{
      height:64px;
      display:flex; align-items:center; justify-content:space-between;
      gap:12px;
    }
    .brand{
      display:flex; align-items:center; gap:10px;
      text-decoration:none;
      min-width: 170px;
    }
    .mark{width:44px;height:44px; filter: drop-shadow(0 8px 14px rgba(11,27,42,.10));}
    .brand strong{display:block; font-size:16px; line-height:1}
    .brand span{display:block; font-size:12.5px; color:var(--muted); margin-top:2px}
    nav{display:flex; gap:10px; align-items:center}
    nav a{
      text-decoration:none;
      font-size:13.5px;
      color:var(--muted);
      padding:10px 10px;
      border-radius:999px;
    }
    nav a:hover{background: rgba(255,79,163,.08); color:var(--ink)}
    .btn{
      border:1px solid var(--line);
      background:#fff;
      border-radius:999px;
      padding:12px 16px;
      font-weight:900;
      cursor:pointer;
      text-decoration:none;
      display:inline-flex; align-items:center; justify-content:center;
      gap:10px;
      box-shadow: var(--shadow);
      transition:.12s ease;
      user-select:none;
    }
    .btn:active{transform: translateY(1px)}
    .btnPrimary{
      background: linear-gradient(135deg, var(--pink), #ff7cc5);
      border-color: rgba(255,79,163,.20);
      color:#fff;
    }
    .btnGhost{background:#fff}
    .btnGhost:hover{background: rgba(0,0,0,.02)}
    @media (max-width: 820px){
      nav{display:none}
    }

    /* Layout */
    .hero{
      padding: 18px 0 6px;
    }
    .heroGrid{
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap: 18px;
      align-items:start;
    }
    @media (max-width: 920px){
      .heroGrid{grid-template-columns:1fr; gap:14px}
    }

    .panel{
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      background:#fff;
      padding: 16px;
    }
    .kicker{
      display:inline-flex; gap:8px; align-items:center;
      padding:8px 12px;
      border-radius:999px;
      border:1px solid rgba(255,79,163,.18);
      background: rgba(255,79,163,.06);
      font-weight:900;
      font-size:12.5px;
    }
    h1{
      margin:12px 0 10px;
      font-size:38px;
      line-height:1.05;
      letter-spacing:-.6px;
    }
    @media (max-width: 520px){ h1{font-size:32px} }

    .sub{
      margin:0 0 14px;
      color:var(--muted);
      line-height:1.55;
      font-size:15.5px;
      max-width: 58ch;
    }

    .chips{display:flex; flex-wrap:wrap; gap:10px; margin: 10px 0 14px}
    .chip{
      border:1px solid var(--line);
      background:#fff;
      padding:10px 12px;
      border-radius:999px;
      font-size:13px;
      cursor:pointer;
      box-shadow: none;
    }
    .chip:hover{background: rgba(0,0,0,.02)}

    .heroActions{display:flex; gap:10px; flex-wrap:wrap; margin-top: 10px}

    /* Media */
    .media{
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      background:#fff;
      min-height: 360px;
      position:relative;
    }
    .media img, .media video{width:100%; height:100%; object-fit:cover; display:block}
    .badge{
      position:absolute; left:12px; top:12px;
      background: rgba(255,255,255,.92);
      border:1px solid var(--line);
      border-radius:999px;
      padding:8px 10px;
      font-weight:900;
      font-size:12.5px;
    }

    /* Sections */
    .section{padding: 10px 0}
    .grid2{display:grid; grid-template-columns:1fr 1fr; gap:14px}
    @media (max-width: 920px){ .grid2{grid-template-columns:1fr} }
    h2{margin:0 0 8px; font-size:18px}
    ul{margin:10px 0 0; padding-left: 18px; color:var(--muted); line-height:1.55}
    li{margin:8px 0}

    /* Flow */
    .flowHead{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
      margin-bottom: 10px;
    }
    .steps{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
    .step{
      width:30px; height:30px;
      display:grid; place-items:center;
      border-radius:999px;
      border:1px solid var(--line);
      color:var(--muted);
      font-weight:900;
      font-size:13px;
    }
    .step.active{
      background: rgba(255,79,163,.10);
      border-color: rgba(255,79,163,.25);
      color: var(--ink);
    }

    label.lbl{
      display:block;
      font-weight:900;
      font-size:12.5px;
      margin: 10px 0 6px;
    }
    input, textarea, select{
      width:100%;
      border:1px solid var(--line);
      border-radius: 14px;
      padding: 12px 12px;
      font-size: 14.5px;
      background:#fff;
      outline:none;
    }
    textarea{min-height: 110px; resize: vertical}
    input:focus, textarea:focus, select:focus{
      border-color: rgba(255,79,163,.35);
      box-shadow: 0 0 0 4px rgba(255,79,163,.10);
    }
    .helper{font-size:12.5px; color:var(--muted); margin-top:6px; line-height:1.45}
    .row{display:grid; grid-template-columns:1fr 1fr; gap:12px}
    @media (max-width: 760px){ .row{grid-template-columns:1fr} }

    .actions{
      display:flex; justify-content:space-between; align-items:center;
      gap:10px; flex-wrap:wrap;
      margin-top: 14px;
    }

    /* Pack tiles: simpler */
    .packTiles{display:grid; gap:10px; margin-top:10px}
    .tile{
      border:1px solid var(--line);
      border-radius: 14px;
      background:#fff;
      padding:12px;
      cursor:pointer;
    }
    .tile.active{
      border-color: rgba(255,79,163,.35);
      background: rgba(255,79,163,.05);
    }
    .tileTop{display:flex; justify-content:space-between; align-items:center; gap:10px}
    .pill{
      font-size:11px; font-weight:900;
      padding:6px 8px;
      border-radius:999px;
      border:1px solid rgba(255,79,163,.18);
      background: rgba(255,79,163,.06);
      color: var(--ink);
      white-space:nowrap;
    }
    .tile p{margin:8px 0 0; color:var(--muted); font-size:12.8px; line-height:1.45}

    .priceLine{
      display:flex; justify-content:space-between; align-items:center; gap:10px;
      border-top:1px solid var(--line);
      padding-top: 12px;
      margin-top: 12px;
      color: var(--muted);
      font-size:13px;
    }
    .priceLine b{color:var(--ink)}

    /* Konfigurator */
    .configRow{display:flex;gap:10px;flex-wrap:wrap}
    .pick{
      display:inline-flex;gap:8px;align-items:center;
      border:1px solid var(--line);
      border-radius:999px;
      padding:10px 12px;
      background:#fff;
      font-size:13px;
      user-select:none;
    }
    .pick input{accent-color: var(--pink)}
    .cookiePreview{
      width:100%;
      min-height: 240px;
      display:grid;
      place-items:center;
      border:1px dashed rgba(11,27,42,.18);
      border-radius: 14px;
      background: rgba(255,79,163,.03);
    }

    /* FAQ */
    details{
      border:1px solid var(--line);
      border-radius: 14px;
      padding: 12px;
      background:#fff;
    }
    details + details{margin-top:10px}
    summary{cursor:pointer; font-weight:900}
    details p{margin:10px 0 0; color:var(--muted); line-height:1.55; font-size:13.5px}

    /* Footer */
    footer{
      border-top:1px solid var(--line);
      padding: 18px 0 26px;
      margin-top: 16px;
      background:#fff;
    }
    .footGrid{display:grid; grid-template-columns: 1.2fr .8fr; gap:14px}
    @media (max-width: 920px){ .footGrid{grid-template-columns:1fr} }
    .footLinks{display:flex; gap:10px; flex-wrap:wrap}
    .footLinks a{
      text-decoration:none;
      font-size:13px;
      color:var(--muted);
      padding:10px 12px;
      border:1px solid var(--line);
      border-radius:999px;
      background:#fff;
    }
    .footLinks a:hover{background: rgba(0,0,0,.02); color:var(--ink)}

    /* Consent */
    .consent{
      position:fixed; left:14px; right:14px; bottom:14px;
      z-index:90; display:none;
    }
    .consent.show{display:block}
    .consentCard{
      max-width: 980px; margin:0 auto;
      border:1px solid var(--line);
      border-radius: 16px;
      background: rgba(255,255,255,.95);
      box-shadow: var(--shadow);
      padding: 12px;
      display:flex; justify-content:space-between; gap:12px; flex-wrap:wrap;
      backdrop-filter: blur(12px);
    }
    .consentCard b{display:block; margin-bottom:4px}
    .consentCard p{margin:0; color:var(--muted); font-size:13px; line-height:1.45}
    .btnSmall{padding:10px 12px; font-size:13px}

    /* --- GENESIS REVEAL OVERLAY --- */
    .revealOverlay{
      position:fixed; inset:0;
      background: rgba(11,27,42,.55);
      display:none;
      align-items:center; justify-content:center;
      padding:18px;
      z-index:9999;
    }
    .revealCard{
      width:min(560px, 100%);
      background:#fff;
      border-radius:18px;
      border:1px solid var(--line);
      box-shadow: 0 18px 60px rgba(11,27,42,.22);
      overflow:hidden;
    }
    .revealTop{
      padding:16px 16px 12px;
      background: linear-gradient(180deg, rgba(255,79,163,.12), rgba(255,79,163,.03));
      border-bottom:1px solid var(--line);
    }
    .revealTitle{
      margin:0;
      font-size:16px;
      letter-spacing:.2px;
    }
    .revealBody{ padding:14px 16px 16px; }
    .revealBadge{
      display:inline-flex; align-items:center; gap:8px;
      padding:10px 12px;
      border-radius:999px;
      border:1px solid rgba(255,79,163,.35);
      background: rgba(255,79,163,.06);
      font-weight:700;
    }
    .revealHint{
      margin:10px 0 0;
      font-size:13px;
      line-height:1.45;
    }
    .revealActions{
      display:flex; gap:10px; justify-content:flex-end;
      padding:12px 16px 16px;
    }
    .revealSmall{
      font-size:12px;
      opacity:.8;
    }

    /* Optional: ultra-leichtes Cookie-Rain */
    .cookieDrop{
      position:fixed;
      top:-40px;
      font-size:18px;
      opacity:.25;
      pointer-events:none;
      z-index:1;
      animation: drop linear forwards;
      filter: drop-shadow(0 10px 14px rgba(11,27,42,.12));
    }
    @keyframes drop{
      to{ transform: translateY(calc(100vh + 60px)) rotate(120deg); }
    }
    @media (prefers-reduced-motion: reduce){
      .cookieDrop{display:none}
    }
  </style>
</head>

<body>
  <!-- INTRO OVERLAY -->
  <div id="intro" class="intro" aria-hidden="false">
    <video id="introVid" class="introVid" autoplay muted playsinline preload="auto">
      <source src="assets/video/intro.mp4" type="video/mp4">
    </video>
    <button id="skipIntro" class="introSkip" type="button">Skip</button>
  </div>

  <!-- TOPBAR -->
  <header class="topbar">
    <div class="wrap">
      <div class="inner">
        <a class="brand" href="#top" aria-label="OnlyKeks Start">
          <svg class="mark" viewBox="0 0 64 64" role="img" aria-label="OnlyKeks Cookie Logo">
            <defs>
              <linearGradient id="g1" x1="0" y1="0" x2="1" y2="1">
                <stop offset="0" stop-color="#ff4fa3"/>
                <stop offset="1" stop-color="#ff7cc5"/>
              </linearGradient>
            </defs>
            <path d="M32 8c-9.4 0-17.6 5.6-21 13.7-2 4.7-2 10 0 14.7C14.4 44.4 22.6 50 32 50c11 0 20.4-7.7 22.6-18.1.8-3.7.4-7.5-1.2-10.9C49.6 13 41.4 8 32 8Z" fill="#f4c9a2" stroke="rgba(11,27,42,.12)" stroke-width="1.2"/>
            <circle cx="49" cy="18" r="7.2" fill="rgba(255,255,255,.96)"/>
            <circle cx="53.8" cy="22.6" r="5.3" fill="rgba(255,255,255,.96)"/>
            <circle cx="24" cy="24" r="2.4" fill="url(#g1)"/>
            <circle cx="37" cy="26.5" r="2.2" fill="rgba(11,27,42,.28)"/>
            <circle cx="28.5" cy="36" r="2.1" fill="rgba(255,79,163,.65)"/>
            <circle cx="40.5" cy="37.5" r="2.6" fill="rgba(11,27,42,.22)"/>
          </svg>
          <div>
            <strong>OnlyKeks</strong>
            <span>Post, die schmeckt</span>
          </div>
        </a>

        <nav aria-label="Navigation">
          <a href="#how">So l√§uft‚Äôs</a>
          <a href="#flow">QR-Antwort-Flow</a>
          <a href="#faq">FAQ</a>
        </nav>

        <a class="btn btnPrimary" href="#flow">Jetzt starten ‚Üí</a>
      </div>
    </div>
  </header>

  <main id="top">
    <!-- HERO -->
    <section class="hero">
      <div class="wrap">
        <div class="heroGrid">
          <div class="panel">
            <div class="kicker">Kein Account ¬∑ QR-Antwort ¬∑ echtes Post-Feeling</div>

            <h1>Schicke s√º√üe Botschaften ‚Äì und hol dir ‚Äône QR-Antwort zur√ºck.</h1>
            <p class="sub">
              Du schickst einen <b>QR-Antwort-Keks</b> mit Message + QR-Code. Empf√§nger*in scannt, antwortet ‚Äì wir backen den <b>Antwort-Keks</b> und schicken ihn zu dir zur√ºck.
            </p>

            <div class="chips" aria-label="Vorlagen">
              <button class="chip" type="button" data-msg="Ich denk an dich. üç™">Ich denk an dich</button>
              <button class="chip" type="button" data-msg="Beweg dein Arsch ‚Äì du packst das! ‚ú®">Motivation</button>
              <button class="chip" type="button" data-msg="Happy Birthday! üéâ">Geburtstag</button>
              <button class="chip" type="button" data-msg="Vermiss dich. üíó">Vermissen</button>
            </div>

            <div class="heroActions">
              <a class="btn btnPrimary" href="#flow">Keks gestalten ‚Üí</a>
              <a class="btn btnGhost" href="#how">Erst kurz checken</a>
            </div>

            <hr class="hr" />

            <div class="muted" style="font-size:13.5px; line-height:1.45;">
              <b style="color:var(--ink)">Loop:</b> Empf√§nger*in antwortet in Sekunden ‚Äì wir k√ºmmern uns um den Rest.
            </div>
          </div>

          <aside class="media" aria-label="Hero Media">
            <span class="badge">Geschenk-Mood ¬∑ Echt</span>

            <video id="heroVideo" autoplay muted playsinline loop preload="metadata" poster="assets/img/1000149739.jpg" style="display:none">
              <source src="assets/img/grok_video_2025-12-13-20-49-35.mp4" type="video/mp4"/>
            </video>
            <img id="heroImg" src="assets/img/1000149739.jpg" alt="Jemand h√§lt einen Keks, scannt den QR-Code und l√§chelt" loading="eager" decoding="async"/>
          </aside>
        </div>
      </div>
    </section>

    <!-- HOW -->
    <section class="section" id="how">
      <div class="wrap">
        <div class="grid2">
          <div class="panel">
            <h2>So l√§uft‚Äôs</h2>
            <ul>
              <li><b>Du schreibst</b> eine Message und w√§hlst ein Paket.</li>
              <li><b>Wir verschicken</b> QR-Antwort-Keks + QR-Karte.</li>
              <li><b>Scan ‚Üí Antwort</b> (ohne Account).</li>
              <li><b>Antwort-Keks</b> kommt zu dir zur√ºck.</li>
            </ul>
          </div>
          <div class="panel">
            <h2>Warum das zieht</h2>
            <ul>
              <li>Emotionaler als Chat, aber genauso schnell.</li>
              <li>Minimaler Flow: kein Shop-Chaos, kein Konto-Theater.</li>
              <li>Clean & vertrauensw√ºrdig (Stripe), klarer Footer.</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- FLOW -->
    <section class="section" id="flow">
      <div class="wrap">
        <div class="panel">
          <div class="flowHead">
            <h2 style="margin:0">QR-Antwort-Flow</h2>
            <div class="steps" aria-label="Schritte">
              <div class="step active" data-step="1">1</div>
              <div class="step" data-step="2">2</div>
              <div class="step" data-step="3">3</div>
              <div class="step" data-step="4">4</div>
              <div class="step" data-step="5">5</div>
            </div>
          </div>

          <!-- Step 1 -->
          <div class="flowPanel" id="p1">
            <label class="lbl" for="msg">Deine Message</label>
            <textarea id="msg" maxlength="500" placeholder="Schreib was S√º√ües‚Ä¶ (max. 500 Zeichen)"></textarea>
            <div class="helper" id="count">0 / 500</div>

            <label class="lbl" for="pack">Paket</label>
            <select id="pack" name="pack">
              <option value="Quick">Quick</option>
              <option value="Custom" selected>Custom</option>
              <option value="Premium">Premium</option>
            </select>

            <div class="packTiles" id="packTiles" role="radiogroup" aria-label="Paket w√§hlen">
              <div class="tile" role="radio" aria-checked="false" data-pack="Quick">
                <div class="tileTop"><b>Quick</b><span class="pill">simpel & sweet</span></div>
                <p>Eine klare Message, klassisch verpackt.</p>
              </div>
              <div class="tile" role="radio" aria-checked="true" data-pack="Custom">
                <div class="tileTop"><b>Custom</b><span class="pill">mehr Deko</span></div>
                <p>Mehr ‚Äúwow‚Äù: Deko-Finish und nicerer Auftritt.</p>
              </div>
              <div class="tile" role="radio" aria-checked="false" data-pack="Premium">
                <div class="tileTop"><b>Premium</b><span class="pill">Box-Vibe</span></div>
                <p>Edle Box, maximaler Geschenk-Moment.</p>
              </div>
            </div>

            <div class="priceLine">
              <div><b id="priceTitle">Custom</b> <span class="muted" id="priceNote">Beliebt ¬∑ Deko-Finish</span></div>
              <div><b id="priceVal">ab 14,90 ‚Ç¨</b></div>
            </div>

            <div class="actions">
              <span class="muted" style="font-size:13px">Schritt 1/5</span>
              <button class="btn btnPrimary" type="button" id="next1">Weiter ‚Üí</button>
            </div>
          </div>

          <!-- Step 2 (Konfigurator) -->
          <div class="flowPanel" id="p2" style="display:none">
            <h2 style="font-size:16px;margin:0 0 6px;">Keks gestalten</h2>
            <p class="muted" style="margin:0 0 10px;font-size:13.5px">
              W√§hl Form & Deko. Der QR-Antwort-Keks sieht dann genau so aus.
            </p>

            <div class="row">
              <div class="tile" style="cursor:default">
                <b>Form</b>
                <div class="configRow" style="margin-top:10px">
                  <label class="pick"><input type="radio" name="shape" value="round" checked> Rund</label>
                  <label class="pick"><input type="radio" name="shape" value="heart"> Herz</label>
                  <label class="pick"><input type="radio" name="shape" value="mouse"> Maus-Keks üê≠üç™</label>
                </div>

                <div style="margin-top:12px">
                  <b>Deko</b>
                  <div class="configRow" style="margin-top:10px">
                    <label class="pick"><input type="checkbox" id="dSprinkles"> Sprinkles</label>
                    <label class="pick"><input type="checkbox" id="dSmiley"> Smiley</label>
                    <label class="pick"><input type="checkbox" id="dKiss"> Kuss-Stempel</label>
                  </div>
                </div>

                <div style="margin-top:12px">
                  <b>Farbe</b>
                  <div style="display:flex;gap:10px;align-items:center;margin-top:10px">
                    <input type="color" id="dIcing" value="#ff4fa3" style="width:54px;height:40px;padding:0;border-radius:12px">
                    <span class="muted" style="font-size:13px">Icing-Akzent</span>
                  </div>
                </div>

                <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap">
                  <button class="btn btnGhost" type="button" id="surpriseBtn">√úberrasch mich üç™</button>
                </div>

                <p class="muted" style="margin:10px 0 0;font-size:12.8px;line-height:1.45">
                  Das ist die Optik-Simulation f√ºrs MVP (sp√§ter: echte Sticker/Undo/Teilen).
                </p>
              </div>

              <div class="tile" style="cursor:default">
                <b>Vorschau</b>
                <div id="cookiePreview" class="cookiePreview" style="margin-top:10px"></div>
                <div class="tile" id="earlyTeaser" style="display:none; margin-top:12px; cursor:default">
                  <b>üç™ Belohnungen</b>
                  <p class="muted" style="margin:6px 0 0">
                    Manche Kekse haben <b>mehr</b> drauf. Details werden beim Scan sichtbar.
                  </p>
                </div>
              </div>
            </div>

            <div class="actions">
              <button class="btn btnGhost" type="button" id="back2">‚Üê Zur√ºck</button>
              <button class="btn btnPrimary" type="button" id="next2">Weiter ‚Üí</button>
            </div>
          </div>

          <!-- Step 3 -->
          <div class="flowPanel" id="p3" style="display:none">
            <h2 style="font-size:16px;margin:0 0 6px;">Adresse</h2>
            <p class="muted" style="margin:0 0 10px;font-size:13.5px">Empf√§nger*in + deine Adresse (f√ºr den Antwort-Keks).</p>

            <div class="row">
              <div>
                <label class="lbl" for="toName">Empf√§nger*in ‚Äì Name</label>
                <input id="toName" placeholder="z. B. Lisa" />
              </div>
              <div>
                <label class="lbl" for="fromName">Dein Name</label>
                <input id="fromName" placeholder="z. B. Schmidti" />
              </div>
            </div>

            <label class="lbl" for="toStreet">Empf√§nger*in ‚Äì Stra√üe & Hausnummer</label>
            <input id="toStreet" placeholder="Musterstra√üe 12" />

            <div class="row">
              <div>
                <label class="lbl" for="toZip">Empf√§nger*in ‚Äì PLZ</label>
                <input id="toZip" inputmode="numeric" placeholder="10115" />
              </div>
              <div>
                <label class="lbl" for="toCity">Empf√§nger*in ‚Äì Ort</label>
                <input id="toCity" placeholder="Berlin" />
              </div>
            </div>

            <label class="lbl" for="fromStreet">Deine Stra√üe & Hausnummer</label>
            <input id="fromStreet" placeholder="Deine Stra√üe 3" />

            <div class="row">
              <div>
                <label class="lbl" for="fromZip">Deine PLZ</label>
                <input id="fromZip" inputmode="numeric" placeholder="12345" />
              </div>
              <div>
                <label class="lbl" for="fromCity">Dein Ort</label>
                <input id="fromCity" placeholder="Berlin" />
              </div>
            </div>

            <div class="actions">
              <button class="btn btnGhost" type="button" id="back3">‚Üê Zur√ºck</button>
              <button class="btn btnPrimary" type="button" id="next3">Weiter ‚Üí</button>
            </div>
          </div>

          <!-- Step 4 -->
          <div class="flowPanel" id="p4" style="display:none">
            <h2 style="font-size:16px;margin:0 0 6px;">Check</h2>
            <div class="muted" id="summary" style="font-size:13.5px; line-height:1.55;"></div>

            <div class="actions">
              <button class="btn btnGhost" type="button" id="back4">‚Üê Zur√ºck</button>
              <button class="btn btnPrimary" type="button" id="next4">Weiter zum Bezahlen ‚Üí</button>
            </div>
          </div>

          <!-- Step 5 -->
          <div class="flowPanel" id="p5" style="display:none">
            <h2 style="font-size:16px;margin:0 0 6px;">Bezahlen</h2>
            <p class="muted" style="margin:0 0 10px;font-size:13.5px">Weiterleitung √ºber Stripe.</p>

            <div class="tile" style="cursor:default">
              <div class="muted" style="font-size:13.5px; line-height:1.55">
                <b style="color:var(--ink)">OrderID:</b> <span id="oid">(wird erstellt)</span><br/>
                <b style="color:var(--ink)">Paket:</b> <span id="sPack">Custom</span><br/>
                <b style="color:var(--ink)">Message:</b> <span id="sMsg">(deine Message)</span><br/>
                <b style="color:var(--ink)">Design:</b> <span id="sDesign">‚Äî</span><br/>
                <b style="color:var(--ink)">Extras:</b> <span id="sExtras">‚Äî</span>
              </div>
            </div>

            <div class="actions">
              <button class="btn btnGhost" type="button" id="back5">‚Üê Zur√ºck</button>
              <a class="btn btnPrimary" id="payBtn" href="#" rel="noopener">Jetzt mit Stripe bezahlen ‚Üí</a>
            </div>
          </div>

        </div>
      </div>
    </section>

    <!-- FAQ -->
    <section class="section" id="faq">
      <div class="wrap">
        <div class="panel">
          <h2>FAQ</h2>
          <details>
            <summary>Wie antwortet die Empf√§nger*in?</summary>
            <p>√úber den QR-Code auf der Karte. Kein Konto, keine App. Scan ‚Üí Text tippen ‚Üí absenden.</p>
          </details>
          <details>
            <summary>Was passiert nach der Antwort?</summary>
            <p>Wir backen den <b>Antwort-Keks</b> mit der Antwort-Message und schicken ihn an deine Adresse zur√ºck.</p>
          </details>
          <details>
            <summary>Welche Daten speichert ihr?</summary>
            <p>Im MVP speichern wir lokal im Browser deinen Entwurf. Optionales Tracking ist standardm√§√üig aus.</p>
          </details>
        </div>
      </div>
    </section>

  </main>

  <footer>
    <div class="wrap">
      <div class="footGrid">
        <div>
          <div style="display:flex;align-items:center;gap:10px;">
            <b>OnlyKeks</b>
            <span class="muted" style="font-size:13px">Post, die schmeckt</span>
          </div>
          <p class="muted" style="margin:10px 0 0; font-size:13px; line-height:1.45">
            MVP: One-Page + QR-Antwort-Flow. Clean, schnell, vertrauensw√ºrdig.
          </p>
        </div>
        <div class="footLinks" aria-label="Footer Links">
          <a href="#faq">FAQ</a>
          <a href="privacy.html">Wie wir mit Daten umgehen</a>
          <a href="keks.html">QR-Antwort Demo</a>
          <a href="#top">Nach oben</a>
        </div>
      </div>
    </div>
  </footer>

  <!-- COOKIE CONSENT -->
  <div class="consent" id="consent">
    <div class="consentCard" role="dialog" aria-label="Cookie Hinweis" aria-modal="true">
      <div>
        <b>Cookie-Kr√ºmel üç™</b>
        <p>Notwendig: Entwurf speichern. Optional: verstehen, welche Kekse gefallen. Wir verkaufen keine Daten.</p>
      </div>
      <div style="display:flex;gap:10px;flex-wrap:wrap;justify-content:flex-end">
        <button class="btn btnPrimary btnSmall" type="button" id="consentAll">Alles klar üç™</button>
        <button class="btn btnGhost btnSmall" type="button" id="consentNeed">Nur das N√∂tigste</button>
        <a class="btn btnGhost btnSmall" href="privacy.html">Details</a>
      </div>
    </div>
  </div>

  <!-- GENESIS REVEAL OVERLAY (hidden) -->
  <div class="revealOverlay" id="revealOverlay" aria-hidden="true">
    <div class="revealCard" role="dialog" aria-modal="true" aria-label="Keks Reveal">
      <div class="revealTop">
        <h3 class="revealTitle">üç™ Scan-Ergebnis</h3>
        <div class="revealSmall muted" id="revealSub"></div>
      </div>
      <div class="revealBody">
        <div class="revealBadge" id="revealBadge">‚ú® Special Keks</div>
        <p class="revealHint muted" id="revealText"></p>
        <div class="tile" style="margin-top:12px; cursor:default">
          <b>Dein Status</b>
          <div class="muted" style="margin-top:6px;font-size:13px" id="revealStatus"></div>
        </div>
      </div>
      <div class="revealActions">
        <button class="btn btnGhost" type="button" id="revealClose">Sp√§ter</button>
        <button class="btn btnPrimary" type="button" id="revealGo">Antwort schreiben ‚Üí</button>
      </div>
    </div>
  </div>

  <script>
    /*** CONFIG: STRIPE ***/
    const STRIPE_PAYMENT_LINK = "https://buy.stripe.com/aBcDeFgHiJkLmNoPqR";

    const $ = (id)=>document.getElementById(id);
    const qsa = (sel,root=document)=>Array.from(root.querySelectorAll(sel));

    window.addEventListener("error", (e)=>console.warn("OnlyKeks JS error:", e.message));
    window.addEventListener("unhandledrejection", (e)=>console.warn("OnlyKeks promise error:", e.reason));

    /* Intro Gate (Fullscreen Video before app) */
    (function introGate(){
      const KEY = "onlykeks_intro_seen_v1";
      const intro = $("intro");
      const vid   = $("introVid");
      const skip  = $("skipIntro");

      const showApp = ()=>{
        document.documentElement.classList.add("appReady");
        if(intro) intro.classList.add("hide");
        setTimeout(()=> intro && intro.remove(), 250);
      };

      if(localStorage.getItem(KEY)){
        if(intro) intro.remove();
        document.documentElement.classList.add("appReady");
        return;
      }

      const done = ()=>{
        localStorage.setItem(KEY, "1");
        showApp();
      };

      const failsafe = setTimeout(done, 3500);

      skip?.addEventListener("click", ()=>{
        clearTimeout(failsafe);
        done();
      });

      vid?.addEventListener("ended", ()=>{ clearTimeout(failsafe); done(); });
      vid?.addEventListener("error", ()=>{ clearTimeout(failsafe); done(); });

      const p = vid?.play?.();
      if(p && typeof p.catch === "function"){
        p.catch(()=>{ clearTimeout(failsafe); done(); });
      }
    })();

    /* Hero media fallback */
    (function heroMedia(){
      const v = $("heroVideo");
      const img = $("heroImg");
      if(!v || !img) return;
      const showVideo = ()=>{ img.style.display="none"; v.style.display="block"; };
      const showImg   = ()=>{ v.style.display="none"; img.style.display="block"; };
      showImg();
      v.addEventListener("canplay", showVideo, {once:true});
      v.addEventListener("error", showImg, {once:true});
      const p = v.play();
      if(p && typeof p.catch === "function") p.catch(()=>showImg());
    })();

    /* State */
    const LS_KEY = "onlykeks_order_v2";
    function readState(){ try{return JSON.parse(localStorage.getItem(LS_KEY)||"{}");}catch(e){return{};} }
    function writeState(patch){
      const cur = readState();
      const next = Object.assign({}, cur, patch);
      localStorage.setItem(LS_KEY, JSON.stringify(next));
      return next;
    }
    function uid(){
      const a = Math.random().toString(36).slice(2,8).toUpperCase();
      const b = Date.now().toString(36).slice(-6).toUpperCase();
      return `OK-${b}-${a}`;
    }
    function esc(str){
      return String(str ?? "")
        .replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;")
        .replaceAll('"',"&quot;").replaceAll("'","&#039;");
    }

    function pricing(pack){
      if(pack==="Quick")   return {title:"Quick",   note:"Schnell & sweet", val:"ab 9,90 ‚Ç¨"};
      if(pack==="Premium") return {title:"Premium", note:"Box-Vibe",        val:"ab 19,90 ‚Ç¨"};
      return {title:"Custom", note:"Beliebt ¬∑ Deko-Finish", val:"ab 14,90 ‚Ç¨"};
    }
    function setPriceUI(pack){
      const p = pricing(pack);
      $("priceTitle") && ($("priceTitle").textContent = p.title);
      $("priceNote")  && ($("priceNote").textContent  = p.note);
      $("priceVal")   && ($("priceVal").textContent   = p.val);
    }

    /* Flow panels */
    const panels = {1:$("p1"),2:$("p2"),3:$("p3"),4:$("p4"),5:$("p5")};
    const steps = qsa(".step");
    function go(n){
      Object.entries(panels).forEach(([k,p])=>{ if(p) p.style.display = (+k===n) ? "block":"none"; });
      steps.forEach(s=>s.classList.toggle("active", +s.dataset.step===n));
      document.querySelector("#flow").scrollIntoView({behavior:"smooth", block:"start"});

      if(n===5){
        $("payBtn").href = STRIPE_PAYMENT_LINK;
        const s = readState();
        $("oid").textContent = s.orderId || "(wird erstellt)";
        $("sPack").textContent = s.pack || "Custom";
        $("sMsg").textContent = s.msg ? (s.msg.slice(0,120)+(s.msg.length>120?"‚Ä¶":"")) : "(deine Message)";
        $("sExtras").textContent = (s.extras && s.extras.length) ? s.extras.join(", ") : "‚Äî";
        $("sDesign").textContent = designLabel(s.design);
      }
    }

    /* Message + chips */
    const msg = $("msg");
    const count = $("count");
    function updateCount(){
      if(!msg || !count) return;
      count.textContent = `${msg.value.length} / 500`;
      writeState({msg: msg.value});
    }
    msg?.addEventListener("input", updateCount);

    qsa(".chip").forEach(ch=>{
      ch.addEventListener("click", ()=>{
        if(!msg) return;
        msg.value = ch.dataset.msg || "";
        updateCount();
        document.querySelector("#flow").scrollIntoView({behavior:"smooth", block:"start"});
      });
    });

    /* Pack select + tiles */
    const packSel = $("pack");
    const tiles = qsa(".tile", $("packTiles") || document);
    function setPack(pack){
      packSel && (packSel.value = pack);
      tiles.forEach(t=>{
        const on = (t.dataset.pack === pack);
        t.classList.toggle("active", on);
        t.setAttribute("aria-checked", on ? "true":"false");
      });
      setPriceUI(pack);
      writeState({pack});
    }
    tiles.forEach(t=>t.addEventListener("click", ()=>setPack(t.dataset.pack)));
    packSel?.addEventListener("change", ()=>setPack(packSel.value));

    /* Extras (Step 2 ist jetzt Konfigurator ‚Äì Extras bleiben im State m√∂glich, aber UI ist Konfig) */
    const extrasMap = [
      {id:"xSprinkles", label:"Sprinkles-Look"},
      {id:"xStory", label:"Mini-Story-URL"},
    ];
    function readExtras(){
      const out=[];
      for(const x of extrasMap){
        const el = $(x.id);
        if(el && el.checked) out.push(x.label);
      }
      return out;
    }

    /* Address fields */
    const fields = ["toName","fromName","toStreet","toZip","toCity","fromStreet","fromZip","fromCity"];
    fields.forEach(id=>{
      $(id)?.addEventListener("input", ()=>writeState({[id]: $(id).value}));
    });

    /* Summary */
    function renderSummary(){
      const s = readState();
      const p = pricing(s.pack || "Custom");
      const extras = (s.extras && s.extras.length) ? s.extras.join(", ") : "‚Äî";
      $("summary").innerHTML = `
        <b>Paket:</b> ${esc(s.pack||"Custom")} <span class="muted">(${esc(p.val)})</span><br/>
        <b>Message:</b><br/>${esc(s.msg||"‚Äî")}<br/><br/>
        <b>Design:</b> ${esc(designLabel(s.design))}<br/>
        <b>Extras:</b> ${esc(extras)}<br/><br/>
        <b>Empf√§nger*in:</b> ${esc(s.toName||"‚Äî")}, ${esc(s.toStreet||"‚Äî")}, ${esc((s.toZip||"‚Äî")+" "+(s.toCity||"‚Äî"))}<br/>
        <b>Antwort-Keks an:</b> ${esc(s.fromName||"‚Äî")}, ${esc(s.fromStreet||"‚Äî")}, ${esc((s.fromZip||"‚Äî")+" "+(s.fromCity||"‚Äî"))}
      `;
    }

    /* =========================
       KONFIGURATOR (Design State + Preview)
    ========================= */

    function getDesign(){
      const s = readState();
      return s.design || { shape:"round", sprinkles:false, smiley:false, kiss:false, icing:"#ff4fa3" };
    }
    function setDesign(patch){
      const d = Object.assign(getDesign(), patch);
      writeState({design:d});
      renderPreview();
    }

    function svgCookie(d){
      const icing = d.icing || "#ff4fa3";
      const spr = d.sprinkles ? `
        <circle cx="95" cy="90" r="4" fill="${icing}" opacity=".85"/>
        <circle cx="150" cy="130" r="3" fill="rgba(11,27,42,.25)"/>
        <circle cx="120" cy="160" r="4" fill="${icing}" opacity=".85"/>
        <circle cx="180" cy="165" r="3" fill="rgba(11,27,42,.22)"/>
      ` : "";

      const smile = d.smiley ? `
        <circle cx="140" cy="132" r="3.5" fill="rgba(11,27,42,.45)"/>
        <circle cx="175" cy="132" r="3.5" fill="rgba(11,27,42,.45)"/>
        <path d="M145 150 Q158 164 171 150" fill="none" stroke="rgba(11,27,42,.45)" stroke-width="5" stroke-linecap="round"/>
      ` : "";

      const kiss = d.kiss ? `
        <path d="M150 115c10-8 22-8 32 0c-3 10-12 18-16 20c-4-2-13-10-16-20Z"
          fill="${icing}" opacity=".9"/>
      ` : "";

      const round = `
        <circle cx="160" cy="140" r="90" fill="#f4c9a2" stroke="rgba(11,27,42,.12)" stroke-width="2"/>
      `;
      const heart = `
        <path d="M160 220
          C90 170, 90 120, 125 105
          C145 96, 158 108, 160 118
          C162 108, 175 96, 195 105
          C230 120, 230 170, 160 220Z"
          fill="#f4c9a2" stroke="rgba(11,27,42,.12)" stroke-width="2"/>
      `;
      const mouse = `
        <circle cx="160" cy="150" r="78" fill="#f4c9a2" stroke="rgba(11,27,42,.12)" stroke-width="2"/>
        <circle cx="105" cy="95" r="28" fill="#f4c9a2" stroke="rgba(11,27,42,.12)" stroke-width="2"/>
        <circle cx="215" cy="95" r="28" fill="#f4c9a2" stroke="rgba(11,27,42,.12)" stroke-width="2"/>
      `;

      const shapeSvg = (d.shape==="heart") ? heart : (d.shape==="mouse") ? mouse : round;

      return `
      <svg viewBox="0 0 320 280" width="100%" height="220" role="img" aria-label="Keks Vorschau">
        ${shapeSvg}
        ${spr}
        ${kiss}
        ${smile}
        <circle cx="120" cy="120" r="5" fill="${icing}" opacity=".65"/>
        <circle cx="205" cy="175" r="5" fill="rgba(11,27,42,.20)"/>
      </svg>`;
    }

    function renderPreview(){
      const box = $("cookiePreview");
      if(!box) return;
      const d = getDesign();
      box.innerHTML = svgCookie(d);
    }

    function wireConfigurator(){
      // radio shape
      document.querySelectorAll('input[name="shape"]').forEach(r=>{
        r.addEventListener("change", ()=> setDesign({shape: r.value}));
      });

      const spr = $("dSprinkles");
      const smi = $("dSmiley");
      const kis = $("dKiss");
      const ic  = $("dIcing");

      spr && spr.addEventListener("change", ()=> setDesign({sprinkles: spr.checked}));
      smi && smi.addEventListener("change", ()=> setDesign({smiley: smi.checked}));
      kis && kis.addEventListener("change", ()=> setDesign({kiss: kis.checked}));
      ic  && ic.addEventListener("input",  ()=> setDesign({icing: ic.value}));

      // restore UI from state
      const d = getDesign();
      const r = document.querySelector(`input[name="shape"][value="${d.shape}"]`);
      r && (r.checked = true);
      spr && (spr.checked = !!d.sprinkles);
      smi && (smi.checked = !!d.smiley);
      kis && (kis.checked = !!d.kiss);
      ic  && (ic.value = d.icing || "#ff4fa3");

      renderPreview();
    }

    function randomDesignPreset(){
      const presets = [
        {shape:"round", sprinkles:true,  smiley:true,  kiss:false, icing:"#ff4fa3"}, // S√º√ü
        {shape:"mouse", sprinkles:true,  smiley:false, kiss:true,  icing:"#ff7cc5"}, // Frech
        {shape:"heart", sprinkles:false, smiley:false, kiss:true,  icing:"#ff4fa3"}, // Elegant
      ];
      const p = presets[Math.floor(Math.random()*presets.length)];
      setDesign(p);
      // sync inputs
      const r = document.querySelector(`input[name="shape"][value="${p.shape}"]`);
      r && (r.checked = true);
      $("dSprinkles") && ($("dSprinkles").checked = !!p.sprinkles);
      $("dSmiley")    && ($("dSmiley").checked = !!p.smiley);
      $("dKiss")      && ($("dKiss").checked = !!p.kiss);
      $("dIcing")     && ($("dIcing").value = p.icing || "#ff4fa3");
    }

    function designLabel(d){
      d = d || getDesign();
      const parts = [];
      parts.push(d.shape==="heart" ? "Herz" : d.shape==="mouse" ? "Maus" : "Rund");
      if(d.sprinkles) parts.push("Sprinkles");
      if(d.smiley) parts.push("Smiley");
      if(d.kiss) parts.push("Kuss");
      return parts.length ? parts.join(" ¬∑ ") : "‚Äî";
    }

    $("surpriseBtn")?.addEventListener("click", randomDesignPreset);

    /* =========================
       EARLY / GENESIS / INVITES + REWARDS (HIDDEN)
    ========================= */

    function getUID(){
      const s = readState();
      if(s.uid) return s.uid;
      const uid = "u_" + Math.random().toString(16).slice(2) + Date.now().toString(16);
      writeState({uid});
      return uid;
    }

    const EARLY_CUTOFF_ISO = "2026-03-31T23:59:59.000Z"; // sp√§ter anpassen
    const GENESIS_MAX_ORDERS = 1000; // placeholder (sp√§ter server truth)

    function ensureEarlyProfile(){
      const s0 = readState();
      const now = new Date().toISOString();
      if(!s0.firstSeen) writeState({firstSeen: now});

      const s = readState();
      const firstSeen = new Date(s.firstSeen || now);
      const isEarlyByDate = firstSeen <= new Date(EARLY_CUTOFF_ISO);

      const orderCount = +(s.orderCount || 0);

      const earlyMember = (s.earlyMember === true) || isEarlyByDate;
      const genesis = (s.genesis === true) || (earlyMember && orderCount < GENESIS_MAX_ORDERS);
      const inviteSlots = (typeof s.inviteSlots === "number") ? s.inviteSlots : (earlyMember ? 3 : 0);

      writeState({
        earlyMember,
        genesis,
        inviteSlots,
        kt: +(s.kt || 0),
        level: s.level || 1
      });

      return readState();
    }

    function applyReferralFromUrl(){
      const p = new URLSearchParams(location.search);
      const ref = p.get("ref");
      if(!ref) return;
      const s = readState();
      if(s.referredBy) return; // only once
      writeState({referredBy: ref, referredAt: new Date().toISOString()});
      grantKT("REF_JOIN", 1);
    }

    function getInviteLink(){
      const uid = getUID();
      return `${location.origin}${location.pathname}?ref=${encodeURIComponent(uid)}`;
    }

    const KT_RULES = {
      BUY: 1,
      BUY_PREMIUM: 2,
      QR_ANSWER_SENT: 1,
      ANSWER_WITH_IMAGE: 1,
      REFERRED_CONVERT: 3,
      REF_JOIN: 1
    };

    const REWARD_MULT = {
      STANDARD: 1.0,
      EARLY: 1.8,
      GENESIS: 3.0
    };

    function levelBoost(level){
      if(level >= 5) return 1.35;
      if(level >= 4) return 1.25;
      if(level >= 3) return 1.15;
      if(level >= 2) return 1.08;
      return 1.0;
    }

    function userStatus(s){
      if(s && s.genesis) return "GENESIS";
      if(s && s.earlyMember) return "EARLY";
      return "STANDARD";
    }

    function updateLevel(){
      const s = readState();
      const kt = +(s.kt||0);
      let level = 1;
      if(kt >= 10) level = 2;
      if(kt >= 25) level = 3;
      if(kt >= 50) level = 4;
      if(kt >= 100) level = 5;
      writeState({level});
    }

    function calcReward(reason){
      const s = readState();
      const base = KT_RULES[reason] || 0;
      const stat = userStatus(s);
      const mult = REWARD_MULT[stat] || 1.0;
      const boost = levelBoost(+(s.level||1));
      return Math.round(base * mult * boost);
    }

    function grantKT(reason, amount){
      const s = readState();
      const log = Array.isArray(s.ktLog) ? s.ktLog : [];
      const now = Date.now();
      const last = log[log.length-1];
      if(last && last.r === reason && (now - last.t) < 3000) return;

      const kt = Math.max(0, +(s.kt||0) + (amount||0));
      log.push({t: now, r: reason, a: amount||0});
      writeState({kt, ktLog: log.slice(-200)});
      updateLevel();
    }

    function showReveal(){
      const ov = $("revealOverlay");
      if(!ov) return;

      const s = ensureEarlyProfile();
      const badge = $("revealBadge");
      const sub   = $("revealSub");
      const txt   = $("revealText");
      const st    = $("revealStatus");

      const isGenesis = !!s.genesis;
      const isEarly = !!s.earlyMember;

      sub.textContent = `Status: ${isGenesis ? "Genesis" : (isEarly ? "Early" : "Standard")} ¬∑ Level ${s.level} ¬∑ Stempel: ${s.kt}`;

      if(isGenesis){
        badge.textContent = "‚ú® Genesis-Keks";
        txt.innerHTML =
          `Du h√§ltst einen <b>Genesis-Keks</b>. Die gibt‚Äôs nicht mehr, wenn sie weg sind. ` +
          `Manche Details sind absichtlich <b>nicht nachbaubar</b> ‚Äì genau darum ist er besonders.`;
      }else if(isEarly){
        badge.textContent = "üåô Early-Keks";
        txt.innerHTML =
          `Du bist im <b>Early Circle</b>. Manche Drops und Belohnungen sind nur f√ºr euch ‚Äì ` +
          `und werden sp√§ter nie wieder so fett.`;
      }else{
        badge.textContent = "üç™ Special m√∂glich";
        txt.innerHTML =
          `Manche Kekse haben versteckte Extras. Sammel Stempel ‚Äì dann geht‚Äôs auf.`;
      }

      const link = getInviteLink();
      st.innerHTML =
        `Einladungen: <b>${s.inviteSlots||0}</b><br>` +
        (s.earlyMember
          ? `Dein Invite-Link: <span class="muted">${link}</span>`
          : `Hol dir Stempel durch Antworten und K√§ufe ‚Äì dann kommste hoch.`);

      ov.style.display = "flex";
      ov.setAttribute("aria-hidden","false");

      $("revealClose") && ($("revealClose").onclick = ()=>{
        ov.style.display = "none";
        ov.setAttribute("aria-hidden","true");
      });

      $("revealGo") && ($("revealGo").onclick = ()=>{
        ov.style.display = "none";
        ov.setAttribute("aria-hidden","true");
        // optional: direkt in Flow springen
        document.querySelector("#flow").scrollIntoView({behavior:"smooth", block:"start"});
      });
    }

    function bootRevealIfScan(){
      const p = new URLSearchParams(location.search);
      if(p.get("scan") === "1") showReveal();
    }

    function bootEarlyLayer(){
      getUID();
      ensureEarlyProfile();
      applyReferralFromUrl();
      bootRevealIfScan();

      const s = readState();
      const teaser = $("earlyTeaser");
      if(teaser && (s.earlyMember || s.genesis)) teaser.style.display = "";
    }

    /* Optional: Cookie Rain (dezent, inkl. Maus) */
    function startCookieRain(){
      if(window.matchMedia && window.matchMedia("(prefers-reduced-motion: reduce)").matches) return;
      let n = 0;
      const max = 18;
      const types = ["smiley","classic","mouse"];
      const tick = ()=>{
        if(!document.documentElement.classList.contains("appReady")) return;
        if(n++ > max) return;
        const el = document.createElement("div");
        el.className = "cookieDrop";
        const t = types[Math.floor(Math.random()*types.length)];
        el.textContent = (t==="mouse") ? "üê≠üç™" : (t==="smiley") ? "üç™üôÇ" : "üç™";
        el.style.left = Math.floor(Math.random()*100) + "vw";
        el.style.animationDuration = (3.2 + Math.random()*2.6).toFixed(2) + "s";
        document.body.appendChild(el);
        setTimeout(()=>el.remove(), 8000);
        setTimeout(tick, 180 + Math.random()*220);
      };
      setTimeout(tick, 450);
    }

    /* Buttons */
    $("next1")?.addEventListener("click", ()=>{
      const txt = (msg?.value || "").trim();
      if(!txt){ msg?.focus(); return; }
      go(2);
    });
    $("back2")?.addEventListener("click", ()=>go(1));
    $("next2")?.addEventListener("click", ()=>go(3));
    $("back3")?.addEventListener("click", ()=>go(2));
    $("next3")?.addEventListener("click", ()=>{
      const s = readState();
      const need = ["toName","toStreet","toZip","toCity","fromName","fromStreet","fromZip","fromCity"];
      const missing = need.filter(k=>!String(s[k]||"").trim());
      if(missing.length){ $(missing[0])?.focus(); return; }
      renderSummary();
      go(4);
    });
    $("back4")?.addEventListener("click", ()=>go(3));
    $("next4")?.addEventListener("click", ()=>{
      const s = readState();
      if(!s.orderId) writeState({orderId: uid()});
      go(5);
    });
    $("back5")?.addEventListener("click", ()=>go(4));

    /* Pay click (hidden rewards placeholder: z√§hlt als Kauf-Intent) */
    $("payBtn")?.addEventListener("click", ()=>{
      const s = readState();
      const pack = s.pack || "Custom";
      const reason = (pack==="Premium") ? "BUY_PREMIUM" : "BUY";
      grantKT(reason, calcReward(reason));
      writeState({orderCount: +(s.orderCount||0) + 1});
      ensureEarlyProfile();
    });

    /* Boot restore */
    (function boot(){
      const s = readState();

      if(msg && s.msg){ msg.value = s.msg; }
      updateCount();

      const initialPack = s.pack || "Custom";
      setPack(initialPack);

      // restore addresses
      fields.forEach(id=>{
        const el = $(id);
        if(el && s[id]) el.value = s[id];
      });

      // wire configurator + restore UI
      wireConfigurator();

      // hidden layer
      bootEarlyLayer();

      // optional rain after ready (intro gate)
      setTimeout(startCookieRain, 600);
    })();

    /* Consent */
    const CONSENT_KEY = "onlykeks_consent_v1";
    const consentEl = $("consent");
    function showConsent(){ if(!localStorage.getItem(CONSENT_KEY)) consentEl?.classList.add("show"); }
    function setConsent(mode){ localStorage.setItem(CONSENT_KEY, mode); consentEl?.classList.remove("show"); }
    $("consentAll")?.addEventListener("click", ()=>setConsent("all"));
    $("consentNeed")?.addEventListener("click", ()=>setConsent("need"));
    showConsent();
  </script>
</body>
</html>
